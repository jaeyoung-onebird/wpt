(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[674],{2990:function(e,s,t){Promise.resolve().then(t.bind(t,9352))},9352:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return p}});var a=t(7437),r=t(2265),l=t(6013),n=t(495),i=t(3102),c=t(4693),d=t(3480);/**
 * @license lucide-react v0.363.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let o=(0,d.Z)("ShieldCheck",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]),m=(0,d.Z)("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);var u=t(2022),x=t(4817),h=t(518),f=t(7592),j=t(6264);function p(){let[e,s]=(0,r.useState)([]),[t,d]=(0,r.useState)(0),[p,N]=(0,r.useState)(1),[v,g]=(0,r.useState)(""),[b,y]=(0,r.useState)(null),[k,C]=(0,r.useState)(!0),w=async()=>{C(!0);try{let e={page:p,size:20};v&&(e.search=v),b&&(e.role=b);let t=await j.Nq.getUsers(e);s(t.data.items),d(t.data.total)}catch(e){console.error("Failed to fetch users:",e)}finally{C(!1)}};(0,r.useEffect)(()=>{w()},[p,b]);let z=()=>{N(1),w()},_=async(e,s)=>{if(confirm(s?"유저를 활성화하시겠습니까?":"유저를 비활성화하시겠습니까?"))try{await j.Nq.updateUserStatus(e,{is_active:s}),w()}catch(e){console.error("Failed to update user status:",e),alert("처리에 실패했습니다")}},S=async(e,s)=>{if(confirm("유저 권한을 ".concat(s,"로 변경하시겠습니까?")))try{await j.Nq.updateUserRole(e,{platform_role:s}),w()}catch(e){console.error("Failed to update user role:",e),alert("권한 변경에 실패했습니다. Super Admin 권한이 필요합니다.")}},Z=e=>{switch(e){case"super_admin":return(0,a.jsxs)(c.C,{className:"bg-red-100 text-red-700",children:[(0,a.jsx)(o,{className:"mr-1 h-3 w-3"}),"Super Admin"]});case"admin":return(0,a.jsxs)(c.C,{className:"bg-orange-100 text-orange-700",children:[(0,a.jsx)(m,{className:"mr-1 h-3 w-3"}),"Admin"]});default:return(0,a.jsxs)(c.C,{variant:"outline",children:[(0,a.jsx)(u.Z,{className:"mr-1 h-3 w-3"}),"User"]})}},U=Math.ceil(t/20);return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold",children:"유저 관리"}),(0,a.jsxs)(c.C,{variant:"outline",children:[t,"명"]})]}),(0,a.jsx)(l.Zb,{children:(0,a.jsx)(l.aY,{className:"p-4",children:(0,a.jsxs)("div",{className:"flex flex-wrap items-center gap-4",children:[(0,a.jsxs)("div",{className:"flex flex-1 gap-2",children:[(0,a.jsx)(i.I,{placeholder:"이름, 전화번호, 이메일 검색",value:v,onChange:e=>g(e.target.value),onKeyDown:e=>"Enter"===e.key&&z(),className:"max-w-sm"}),(0,a.jsx)(n.z,{variant:"outline",onClick:z,children:(0,a.jsx)(x.Z,{className:"h-4 w-4"})})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(n.z,{variant:null===b?"default":"outline",size:"sm",onClick:()=>y(null),children:"전체"}),(0,a.jsx)(n.z,{variant:"admin"===b?"default":"outline",size:"sm",onClick:()=>y("admin"),children:"Admin"}),(0,a.jsx)(n.z,{variant:"user"===b?"default":"outline",size:"sm",onClick:()=>y("user"),children:"User"})]})]})})}),(0,a.jsx)(l.Zb,{children:(0,a.jsxs)(l.aY,{className:"p-0",children:[(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"w-full text-sm",children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{className:"border-b bg-muted/50",children:[(0,a.jsx)("th",{className:"p-4 text-left font-medium",children:"이름"}),(0,a.jsx)("th",{className:"p-4 text-left font-medium",children:"전화번호"}),(0,a.jsx)("th",{className:"p-4 text-left font-medium",children:"이메일"}),(0,a.jsx)("th",{className:"p-4 text-center font-medium",children:"권한"}),(0,a.jsx)("th",{className:"p-4 text-center font-medium",children:"프로필"}),(0,a.jsx)("th",{className:"p-4 text-center font-medium",children:"상태"}),(0,a.jsx)("th",{className:"p-4 text-center font-medium",children:"마지막 로그인"}),(0,a.jsx)("th",{className:"p-4 text-center font-medium",children:"액션"})]})}),(0,a.jsx)("tbody",{children:k?(0,a.jsx)("tr",{children:(0,a.jsx)("td",{colSpan:8,className:"p-8 text-center text-muted-foreground",children:"로딩 중..."})}):0===e.length?(0,a.jsx)("tr",{children:(0,a.jsx)("td",{colSpan:8,className:"p-8 text-center text-muted-foreground",children:"유저가 없습니다"})}):e.map(e=>(0,a.jsxs)("tr",{className:"border-b hover:bg-muted/50",children:[(0,a.jsx)("td",{className:"p-4 font-medium",children:e.name}),(0,a.jsx)("td",{className:"p-4 text-muted-foreground",children:e.phone}),(0,a.jsx)("td",{className:"p-4 text-muted-foreground",children:e.email||"-"}),(0,a.jsx)("td",{className:"p-4 text-center",children:Z(e.platform_role)}),(0,a.jsx)("td",{className:"p-4 text-center",children:(0,a.jsxs)("div",{className:"flex justify-center gap-1",children:[e.has_worker_profile&&(0,a.jsx)(c.C,{variant:"secondary",className:"text-xs",children:"근무자"}),e.has_org_membership&&(0,a.jsx)(c.C,{variant:"secondary",className:"text-xs",children:"업체"})]})}),(0,a.jsx)("td",{className:"p-4 text-center",children:e.is_active?(0,a.jsx)(c.C,{className:"bg-green-100 text-green-700",children:"활성"}):(0,a.jsx)(c.C,{variant:"destructive",children:"비활성"})}),(0,a.jsx)("td",{className:"p-4 text-center text-muted-foreground",children:e.last_login_at?new Date(e.last_login_at).toLocaleDateString("ko-KR"):"-"}),(0,a.jsx)("td",{className:"p-4 text-center",children:(0,a.jsxs)("div",{className:"flex justify-center gap-2",children:["user"===e.platform_role&&(0,a.jsx)(n.z,{variant:"outline",size:"sm",onClick:()=>S(e.id,"admin"),children:"Admin 승격"}),"admin"===e.platform_role&&(0,a.jsx)(n.z,{variant:"outline",size:"sm",onClick:()=>S(e.id,"user"),children:"권한 해제"}),e.is_active?(0,a.jsx)(n.z,{variant:"outline",size:"sm",onClick:()=>_(e.id,!1),children:"비활성화"}):(0,a.jsx)(n.z,{size:"sm",onClick:()=>_(e.id,!0),children:"활성화"})]})})]},e.id))})]})}),U>1&&(0,a.jsxs)("div",{className:"flex items-center justify-center gap-2 border-t p-4",children:[(0,a.jsx)(n.z,{variant:"outline",size:"sm",disabled:1===p,onClick:()=>N(e=>e-1),children:(0,a.jsx)(h.Z,{className:"h-4 w-4"})}),(0,a.jsxs)("span",{className:"text-sm text-muted-foreground",children:[p," / ",U]}),(0,a.jsx)(n.z,{variant:"outline",size:"sm",disabled:p===U,onClick:()=>N(e=>e+1),children:(0,a.jsx)(f.Z,{className:"h-4 w-4"})})]})]})})]})}},3102:function(e,s,t){"use strict";t.d(s,{I:function(){return n}});var a=t(7437),r=t(2265),l=t(7440);let n=r.forwardRef((e,s)=>{let{className:t,type:r,...n}=e;return(0,a.jsx)("input",{type:r,className:(0,l.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",t),ref:s,...n})});n.displayName="Input"},4817:function(e,s,t){"use strict";t.d(s,{Z:function(){return a}});/**
 * @license lucide-react v0.363.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,t(3480).Z)("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]])},2022:function(e,s,t){"use strict";t.d(s,{Z:function(){return a}});/**
 * @license lucide-react v0.363.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,t(3480).Z)("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]])}},function(e){e.O(0,[868,472,757,971,23,744],function(){return e(e.s=2990)}),_N_E=e.O()}]);